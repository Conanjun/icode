(function(c){c.fn.extend({faqrobot:function(y,d){d=c.extend({},c.FaqRobot.defaults,{sysNum:"number"==typeof y?y:1E4},d);return this.each(function(){new c.FaqRobot(this,d)})}});c.FaqRobot=function(y,d){function z(a,b,e,f,k){if("string"==typeof a&&0<a.length){var h={timestamp:+new Date,dataType:f||d.dataType},h=c.extend({},h,k);c.each(d.extraParams,function(a,b){h[a]="function"==typeof b?b():b});c.ajax({dataType:d.dataType,url:encodeURI(a),data:h,success:function(a){0>a.status&&"function"==typeof e?
e(a):-1==a.status?d.showErrorMsg&&d.showErrorMsg(a)||setTimeout(C(a.message||"\u8bf7\u6c42\u4fe1\u606f\u9519\u8bef\uff0c\u8bf7\u5237\u65b0\uff01"),2E3):-2==a.status?d.showErrorMsg&&d.showErrorMsg(a)||setTimeout(C(a.message||"\u60a8\u7684\u4fe1\u606f\u8ba4\u8bc1\u672a\u901a\u8fc7\uff0c\u8bf7\u91cd\u65b0\u8ba4\u8bc1\uff01",d.authUrl),2E3):(keepCount=0,F(a),"function"==typeof b&&b(a))},error:function(){d.showErrorMsg&&d.showErrorMsg(data)||C("\u6570\u636e\u8bf7\u6c42\u9519\u8bef\uff0c\u8bf7\u5237\u65b0\uff01")}})}}
function C(a,b,e){w(a,function(){b&&"string"==typeof b&&(location.href=b)})}function G(a){a=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i");a=window.location.search.substr(1).match(a);return null!=a?a[2]:null}function P(a){if(d.quickLink&&2<d.quickLink.length&&"undefined"!=typeof a&&0<a.length){for(var b=[],e=0;e<a.length;e++)b.push('<a class="a'+(e+1)+'" href="'+a[e].linkUrl+'"><img src="'+a[e].imageUrl+'" /><p>'+a[e].name+"</p></a>");c("#"+d.quickLink+" ul").empty().append(b.join("")).append('<a class="vcode" href="#"><img src="skin/dc_dev/image/vcode.jpg" /><p>\u626b\u4e00\u626b \u7801\u4e0a\u6709\u793c</p></a>')}}
function Q(a){var b=c("<div/>").addClass("robot_question").html('<dl class="robot_questionL"><img src="'+d.logoUrl+'"></dl>'),e=c("<dl/>").addClass("robot_questionR").appendTo(b),f=c("<div/>").addClass("robot_questionR_qp").append('<i class="triangle triangle1"></i><i class="triangle triangle2"></i>').appendTo(e),k=c("<div/>").addClass("questionR_txt").appendTo(f);c("<div/>").addClass("robot_questionR_time").html(v()).appendTo(e);c("<div/>").addClass("robot_review_none").after('<div class="clear"></div>').appendTo(f);
d.chatContDiv&&2<d.chatContDiv.length&&"undefined"!=typeof a.leaveQue&&1<a.leaveQue.length||k.html(a.webConfig.helloWord);p.html(b)}function R(a){d.topQuestionDiv&&2<d.topQuestionDiv.length&&"undefined"!=typeof a&&1<a.length&&H(d.topQuestionDiv,a)}function S(a){d.newQuestionDiv&&2<d.newQuestionDiv.length&&"undefined"!=typeof a&&1<a.length&&H(d.newQuestionDiv,a)}function T(a){var b="<dl>";if(d.baseInfoDiv&&2<d.baseInfoDiv.length&&("undefined"!=typeof a.webConfig&&(b="<dl>","undefined"!=typeof a.webConfig.webName&&
(b+="<dt>\u540d\u79f0\uff1a"+a.webConfig.webName+"</dt>"),"undefined"!=typeof a.webConfig.serviceTel&&(b+="<dt>\u7535\u8bdd\uff1a"+a.webConfig.serviceTel+"</dt>"),"undefined"!=typeof a.webConfig.webSite&&(b+='<dt>\u7f51\u5740\uff1a<a href="'+a.webConfig.webSite+'" target="_black">'+a.webConfig.webSite+"</a></dt>")),a.advList&&0<a.advList.length))for(var e=0;e<a.advList.length;e++){var f=a.advList[e].type;0==f?b+="<dt>"+a.advList[e].name+"\uff1a"+a.advList[e].value+"</dt>":1==f?b=0==a.advList[e].value.indexOf("<")&&
0<a.advList[e].value.indexOf(">")?b+("<dt>"+a.advList[e].name+"\uff1a"+a.advList[e].value+""):b+("<dt>"+a.advList[e].name+'\uff1a<a href="javascript:;" href="'+a.advList[e].value+'" target="_blank">'+a.advList[e].value+"</a></dt>"):2==f?b=0==a.advList[e].value.indexOf("<")&&0<a.advList[e].value.indexOf(">")?b+("<dt>"+a.advList[e].name+"\uff1a"+a.advList[e].value+""):b+("<dt>"+a.advList[e].name+'\uff1a<br><img src="'+a.advList[e].value+'">'):3==f&&(b=0==a.advList[e].value.indexOf("<")&&0<a.advList[e].value.indexOf(">")?
b+("<dt>"+a.advList[e].name+"\uff1a"+a.advList[e].value+""):b+("<dt>"+a.advList[e].name+'\uff1a<a href="http://wpa.qq.com/msgrd?v=3&uin='+a.advList[e].value+'&site=qq&menu=yes" target="_blank"><img alt="'+a.advList[e].name+'" src="images/Service1.png"></a>'))}b+="</dl>";c("#"+d.baseInfoDiv).html(b)}function U(a){if(d.advInfoDiv&&2<d.advInfoDiv.length&&"undefined"!=typeof a.webConfig&&1<a.webConfig.length){var b="<table>";"undefined"!=typeof a.webConfig.serviceQq&&(b+='<tr><td>Q\u00a0Q\uff1a</td><td><a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin='+
a.webConfig.serviceQq+'&site=qq&menu=yes"><img border="0" src="http://wpa.qq.com/pa?p=2:'+a.webConfig.serviceQq+':51" alt="QQ\u5728\u7ebf\u5ba2\u670d" title="QQ\u5728\u7ebf\u5ba2\u670d"/></a></td></tr>');if("undefined"!=typeof a.advs)for(a=a.advs,i=0;i<a.length;i++){var e=c.trim(a[i].name),f=c.trim(a[i].value),k=a[i].type;0==k?b+="<tr><td>"+e+"\uff1a</td><td>"+f+"</td></tr>":1==k?b+="<tr><td>"+e+"\uff1a</td><td>"+f+"</td></tr>":2==k?b+="<tr><td>"+e+"\uff1a</td><td>"+f+"</td></tr>":3==k&&(b+="<tr><td>"+
e+'\uff1a</td><td><a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin='+f+'&site=qq&menu=yes"><img border="0" src="http://wpa.qq.com/pa?p=2:'+f+':51" alt="'+e+'" title="'+e+'"/></a></td></tr>')}b+="</table>";c("#"+d.advInfoDiv).html(b)}}function H(a,b,e,f,k){if(!b)return"";a=c("<dl/>").appendTo(c("#"+a));e=I(b.length);for(f=0;f<e;f++)if(b[f]){k=c("<dt/>");var h=d.formatBaseQueCount&&d.formatBaseQueCount(b[f],f+1,e,d.queConMaxWordsCount)||J(b[f].question);!1!==h&&(c("<a/>").html(h).appendTo(k).attr("href",
"javascript:void(0)").attr("title",b[f].question).attr("aid",b[f].solutionId).click(function(){$this=c(this);u($this.attr("title"),$this.attr("aid"));return!1}),k.appendTo(a))}}function J(a,b){return b?a.length>b?a.substring(0,b)+"...":a:a}function I(a){return d.maxTopQuestions&&d.maxTopQuestions<a?d.maxTopQuestions:a}function v(){var a=new Date,b=a.getFullYear(),e=a.getMonth()+1,c=a.getDate(),d=a.getHours(),h=a.getMinutes(),a=a.getSeconds();return b+"-"+e+"-"+c+" "+d+":"+h+":"+a}function w(a,b){D.fadeIn(800);
D.find("span").html(a);D.delay(1E3).fadeTo("slow",.2).fadeTo("slow",1).fadeOut(800,function(){"function"==typeof b&&b()})}function K(){var a="",a=q.val(),a=$xss(a,"html");""!=a&&a!=d.inputMagOldvalue&&(q.val(""),c(".ac_results").hide(),1==a.length&&0<a&&"undefined"!=typeof x[a-1]&&(x=[]),u(a),c("#"+d.wordremain).html(100),q.focus())}function u(a,b){if((d.curQue=a)&&0<a.length){var e=d.basePath+"AQ?s=aq";b&&0<b++&&(e+="&sId="+b+"&sysNum="+d.sysNum);A(a);z(e,r,0,d.dataType,{question:a})}}function A(a){if(a||
0!=a.length){var b;(b=d.showMyWords&&d.showMyWords(a,v()))||(b=v(),b='<div class="robot_ask"><dl class="robot_askL"><i class="triangle triangle1"></i><i class="triangle triangle2"></i><dt>'+a+"<span></span></dt><dd>"+b+'</dd></dl><dl class="robot_askR"><img src="'+d.khUrl+'" class="fixpng"/></dl></div>');p.append(b);B.scrollTop(B[0].scrollHeight);L()}}function r(a){if(a||0!=a.length){var b;if(!(b=d.showRobotWords&&d.showRobotWords(a,v())))if(b=v(),"undefined"==typeof a.robotAnswer||0==a.robotAnswer.length)b=
"";else{for(var e,c,k=0;k<a.robotAnswer.length;k++)c=a.robotAnswer[k],c=V(c,b),e?e.after(c):e=c;b=e}p.append(b);B.scrollTop(B[0].scrollHeight);L()}}function V(a,b){var e="",f="";"undefined"!=typeof a.gusWords&&null!=a.gusWords?(e=""==a.gusWords.ydWords?"\u60a8\u662f\u4e0d\u662f\u8981\u54a8\u8be2\u4e0b\u9762\u7684\u95ee\u9898\uff1f":a.gusWords.ydWords,f=""==a.gusWords.afterWords?"":a.gusWords.afterWords):(e="\u60a8\u662f\u4e0d\u662f\u8981\u54a8\u8be2\u4e0b\u9762\u7684\u95ee\u9898\uff1f",f="");if(!a)return"";
var k=c("<div/>").addClass("robot_question").html('<dl class="robot_questionL"><img src="'+d.logoUrl+'"></dl>'),h=c("<dl/>").addClass("robot_questionR").appendTo(k),g=c("<div/>").addClass("robot_questionR_qp").append('<i class="triangle triangle1"></i><i class="triangle triangle2"></i>').appendTo(h),l=c("<div/>").addClass("questionR_txt").appendTo(g);c("<div/>").addClass("robot_questionR_time").html(v()).appendTo(h);var m=c("<div/>");if("undefined"!=typeof a.aId&&0!=a.aId){var h=a.aId,n=a.cluid;m.addClass("helper_aid_"+
h);c("<a/>").addClass("robot_review_yes").attr("helptag",1).attr("aid",h).attr("uid",n).click(M).html("<span></span>\u6ee1\u610f").appendTo(m);c("<a/>").addClass("robot_review_no").attr("helptag",0).attr("aid",h).attr("uid",n).click(M).html("<code></code>\u4e0d\u6ee1\u610f").appendTo(m);m.addClass("robot_review2")}else m.addClass("robot_review_none");m.after('<div class="clear"></div>').appendTo(g);if("undefined"!=typeof a.aId&&0!=a.aId&&d.sugQuestionDiv&&2<d.sugQuestionDiv.length&&"undefined"!=typeof a.relateLessList&&
1<a.relateLessList.length){var p=c("<div/>").addClass("relateTxt").appendTo(g),t=a.relateLessList;if(!t)return"";for(var q=c("<dl/>").appendTo(p),n=c("<dt/>").html("\u4f60\u662f\u5426\u8fd8\u60f3\u95ee\u5982\u4e0b\u95ee\u9898\uff1a").appendTo(q).css("color","red"),n=I(t.length),g=0;g<n;g++)if(t[g]){var r=d.formatBaseQueCount&&d.formatBaseQueCount(t[g],g+1,n,d.queConMaxWordsCount)||J(t[g].question);!1!==r&&(h=c("<dd/>").appendTo(q).html(g+1+".\u00a0"),m=c("<a/>"),m.html(r).appendTo(h).attr("href",
"javascript:void(0)").attr("title",t[g].question).attr("aid",t[g].solutionId).click(function(){$this=c(this);u($this.attr("title"),$this.attr("aid"));return!1}),x[g]=t[g].question)}p.after(c("<div/>").addClass("clear"))}""!=a.ansCon&&0<a.ansCon.length&&l.html(a.ansCon);if(0<a.relateList.length){n=c("<dl/>").append("<dt>"+e+"</dt>").appendTo(l);l=a.relateList;for(g=0;g<l.length;g++)e=c.trim(l[g].question),h=l[g].solutionId,h=c("<dd/>").appendTo(n).html(g+1+".\u00a0"),m=c("<a/>"),m.html(e).appendTo(h).attr("href",
"javascript:void(0)").attr("title",e).attr("aid",l[g].solutionId).click(function(){$this=c(this);u($this.attr("title"),$this.attr("aid"));return!1}),x[g]=e;c("<dt/>").html(f).appendTo(n);return k}if(0<a.gusList.length){n=c("<dl/>").append("<dt>"+e+"</dt>").appendTo(l);l=a.gusList;for(g=0;g<l.length;g++)e=c.trim(l[g].seedQuestion.question),h=l[g].solutionId,h=c("<dd/>").appendTo(n).html(g+1+".\u00a0"),m=c("<a/>"),m.html(e).appendTo(h).attr("href","javascript:void(0)").attr("title",e).attr("aid",l[g].solutionId).click(function(){$this=
c(this);u($this.attr("title"),$this.attr("aid"));return!1}),x[g]=e;c("<dt/>").html(f).appendTo(n);return k}if(""==a.ansCon)return f=a,"undefined"!=typeof f.sq&&(f='\u5173\u4e8e\u95ee\u9898\u00a0\u00a0"<b>'+data.sq+'</b>"\u00a0\u7684\u56de\u590d\uff1a</br>'+f),l.html("\u00a0"),k;l.html(W(a.ansCon));return k}function N(){var a=d.basePath+"AQ?s=offline&nocache="+(new Date).getTime();c.getJSON(a,function(a){0==a.status&&(a=eval('({"robotAnswer":{"ansCon":"\u60a8\u5df2\u4e0b\u7ebf\uff0c\u611f\u8c22\u60a8\u7684\u4f7f\u7528\uff01\u5982\u679c\u9700\u8981\u518d\u6b21\u804a\u5929\uff0c\u8bf7\u91cd\u65b0\u6253\u5f00\u6216\u5237\u65b0\u672c\u9875\u9762\uff01","status":0,"tspan":2}})'),
r(a))})}function F(a){"undefined"!=typeof a.tspan&&(s_tspan!=a.tspan&&(s_tspan=a.tspan),"undefined"!=typeof dt&&clearTimeout(dt),100>s_tspan&&240>keepCount?(keepCount++,dt=setTimeout(X,1E3*s_tspan)):N())}function X(){c.ajax({type:"post",datatype:"json",cache:!1,url:d.basePath+"AQ?s=kl",data:"question="+d.curQue,success:function(a){0==a.status?(F(a),a.robotAnswer&&0<a.robotAnswer.length&&r(a)):(a=eval('({"robotAnswer":{"ansCon":"\u60a8\u5df2\u4e0b\u7ebf\uff0c\u611f\u8c22\u60a8\u7684\u4f7f\u7528\uff01\u5982\u679c\u9700\u8981\u518d\u6b21\u804a\u5929\uff0c\u8bf7\u91cd\u65b0\u6253\u5f00\u6216\u5237\u65b0\u672c\u9875\u9762\uff01","status":0,"tspan":2}})'),
r(a))}})}function M(){$this=c(this);var a=$this.attr("aid"),b=$this.attr("uid"),e=$this.attr("helptag");c(".helper_aid_"+a).text("\u611f\u8c22\u60a8\u7684\u8bc4\u4ef7!").css("color","#666");var f="",f=1==e?d.basePath+"AQ?s=addufc&aId="+a+"&cluid="+b+"&sysNum="+d.sysNum:d.basePath+"AQ?s=addulc&aId="+a+"&cluid="+b+"&sysNum="+d.sysNum;z(f)}function Y(){$this=c(this);var a=$this.parents("form"),b=d.basePath+"AQ?s=fadeback&sysNum="+d.sysNum,e="",f=c("input[name='reason[]']");for(i=0;i<f.length;i++)f[i].checked&&
(e+=f[i].value+",");a.find("input[name=sub]").val(e);c.ajax({type:"get",datatype:"json",cache:!1,url:encodeURI(b),data:a.serialize(),success:function(b){c(".fadeBackModal").fadeOut(800);c(".fadeBackContent").fadeOut(800);a[0].reset();w(b.message)}})}function L(){c(".nano").nanoScroller({alwaysVisible:!0})}function W(a){return a=a.replace(/\[em_([0-9]*)\]/g,'<img src="/onlineMonitor/monitor/arclist/$1.gif" border="0" />')}var x=[],p=c("#"+d.chatContDiv),B=p.parent(),q=c(y),D=c("#"+d.showErrorId),E=
window.location.href.split("?"),O=[];E[1]&&(O=-1!==E[1].indexOf("jid=")?E[1].split("&"):[""]);q.focus(function(){c(this).val()==c(this).attr("oldvalue")&&c(this).val("");c(this).css("color","#333");c(this).parent().addClass("robot_inputon")}).blur(function(){""==c(this).val()?(c(this).val(c(this).attr("oldvalue")),c(this).css("color","#ccc")):c(this).css("color","#333");c(this).parent().removeClass("robot_inputon")}).autocomplete(d.basePath+"AQ?s=ig&sysNum="+d.sysNum,{max:10,delay:500,matchSubset:!1,
scroll:!1,minChars:2,scrollHeight:400,dataType:"json",selectFirst:!1,highlight:function(a,b){var e=b.split(""),d="";c.each(e,function(b,c){-1==d.indexOf(c)&&(d+=c,a=a.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+c.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>"))});return a.replace("<strong></strong>","")},parse:function(a){for(var b=[],c=0;c<a.list.length;c++)b[b.length]={data:a.list[c],result:a.list[c].question};return b},formatItem:function(a,
b,c){return b+". "+a.question},formatMatch:function(a,b,c){return a},formatResult:function(a){return a}}).result(function(a,b,c){a.preventDefault()}).keyup(function(a){a=a||window.event;27==a.keyCode&&c(this).unautocomplete();return(isHotKey="Enter"==hkey&&!a.ctrlKey&&13==a.keyCode||"CtrlEnter"==hkey&&a.ctrlKey&&13==a.keyCode)?(K(),!1):!0}).keydown(function(){var a=this.value.length,b=0,e=this.value.match(/[\u4E00-\u9FA5\uF900-\uFA2D]/g);null!=e&&(b+=e.length);a=c(this).attr("maxLength")-b-a;if(0>=
a){a=0;b=this.value.substring(0,this.maxLength);for(e=0;e<b.length&&!(a+=/[\u4E00-\u9FA5\uF900-\uFA2D]/.test(b.charAt(e))?2:1,a>this.maxLength);e++);this.value=b.substring(0,e);c("#"+d.wordremain).html(0)}else c("#"+d.wordremain).html(a)});d.fadeBackId&&2<d.fadeBackId.length&&c("#"+d.fadeBackId).click(Y);var Z=function(){var a=G("qa"),b=G("q");a&&(a=decodeURI(a),A(a),u(a));b&&(b=decodeURI(b),q.val(b))};c(".faqevent").live("click",function(){var a=c(this).attr("href"),b=c(this).html(),a=d.basePath+
"AQ?"+a+"&sysNum="+d.sysNum+"&nocache="+(new Date).getTime();A(b);z(a,r,0,d.dataType,{});return!1});c(".wflink").live("click",function(){$this=c(this);var a=$this.attr("rel"),b=$this.html(),a=d.basePath+"AQ?s=getflw&sysNum="+d.sysNum+"&question="+encodeURI(b)+"&fid="+a+"&nocache="+(new Date).getTime();c.getJSON(a,function(a){0==a.status?(A(b),r(a)):w(a.message)})});window.onbeforeunload=function(a){N()};c("#"+d.chatContDiv).on("click",".welcomeWords",function(){u(c(this).html())});-1!==window.location.href.indexOf("sysNum=")&&
(d.sysNum=window.location.href.split("sysNum=")[1].replace("#",""));q.attr("oldvalue",d.inputMagOldvalue);q.text(d.inputMagOldvalue);z(d.basePath+"AQ?s=p&sysNum="+d.sysNum+"&"+O[0],function(a){urlId=location.href.split("?");-1==a.status?w("\u7f51\u7edc\u6709\u70b9\u4e0d\u7ed9\u529b\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u5c1d\u8bd5\u3002"):-2==a.status?(w("\u60a8\u7684\u4fe1\u606f\u8ba4\u8bc1\u672a\u901a\u8fc7\uff0c\u8bf7\u91cd\u65b0\u8ba4\u8bc1\uff01"),location.href=a.loginurl):("undefined"!=typeof a.webConfig.robotName&&
(d.robotName=a.webConfig.robotName),"undefined"!=typeof a.webConfig.logoUrl&&(d.logoUrl=""==a.webConfig.logoUrl?"skin/dc_dev/image/serv_red.png":a.webConfig.logoUrl,c("#"+d.logoDiv).attr("src",d.logoUrl)),c(document).attr("title",a.webConfig.webName),Z(),Q(a),R(a.topAsk),S(a.newAdd),T(a),U(a),P(a.quickLink),c("#"+d.sendBtn).click(function(){K()}),c("#"+d.clearScreen).click(function(){var a=c("<div/>").addClass("robot_question"),d=p.find("div").first().html();p.html("");a.html(d).appendTo(p)}))})};c.FaqRobot.defaults=
{curQue:"",basePath:"./",sysNum:2E6,robotName:"FaqRobot",logoUrl:"skin/robotVedio/image/logo.png",logoDiv:"weblogo",chatContDiv:"chatContentDiv",inputMsgArea:"inputMessage",inputMagOldvalue:"inputMagOldvalue",sendBtn:"sendBtn",closeBtn:"closeBtn",baseInfoDiv:"Contact_us",advInfoDiv:"advInfoDiv",topQuestionDiv:"topQuestions",newQuestionDiv:"newQuestions",sugQuestionDiv:"sugQuestions",viewUrlDiv:"viewUrlDiv",dataType:"json",extraParams:"",webUrl:"http://www.faqrobot.org",authUrl:"",maxTopQuestions:7,
queConMaxWordsCount:0,showMyWords:function(c,d){},showRobotWords:!1,autoswitch:0,wordremain:"wordremain",clearScreen:"clearScreen",fadeBackId:"fadeBackId",showErrorId:"showErrorId",advFaqrobot:"advFaqrobot",kfUrl:"skin/dc_dev/image/serv_pink.png",khUrl:"skin/dc_dev/image/robot_askicon.png",quickLink:"quickLink",formatWebLog:!1,formatBaseQueCount:!1,showErrorMsg:!1}})(jQuery);