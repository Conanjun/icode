<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">  -->
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">  
    <link rel="shortcut icon" href="images/send.png" type="/image/x-icon">  
    <meta http-equiv=”X-UA-Compatible” content=”IE=edge,chrome=1″/>  
    <title>FaqRobot智能问答机器人</title>

    <link rel="stylesheet" href="skin/h5chat_ZR/css/minichat.css?dev=2">
    <link rel="stylesheet" href="skin/h5chat_ZR/css/app.css?dev=1">
    <link rel="stylesheet prefetch" href="skin/h5chat_ZR/css/photoswipe.css">
    <link rel="stylesheet prefetch" href="skin/h5chat_ZR/css/default-skin.css">
    <link rel="stylesheet" href="skin/h5chat_ZR/css/font-awesome.css">

	<style>
		.hide{
			display:none !important;
		}
        .clearfix::before, .clearfix::after {
            display: block;
            content: '';
            visibility: hidden;
            height: 100%;
            clear: both;
        }
        .my-gallery figure{
            width: 100%;
            height: 100%;
            margin: 0;
        }

    </style>
     <!--taskId=447 自如提供 点击显示更多，跳转自如 -->
     <script src="//static8.ziroom.com/fecommon/library/jquery/jquery-1.8.3.min.js"></script>
    <!-- <script type="text/javascript" src="//zhuanti.ziroom.com/zhuanti/2017/0test/H5CallApp/toCallApp.js?20171220"></script> -->
    <script type="text/javascript" src="skin/h5chat_ZR/js/toCallApp.js"></script>
    <script src="skin/h5chat_ZR/js/minichat.js?time=1513"></script>
    <script src="skin/h5chat_ZR/js/app.js?dev=2"></script>
    <script src="skin/h5chat_ZR/js/photoswipe.js"></script>
    <script src="skin/h5chat_ZR/js/photoswipe-ui-default.min.js"></script>
    <!-- <script type="text/javascript" src="//zhuanti.ziroom.com/zhuanti/2017/0test/H5CallApp/toCallApp.js?20171220"></script> -->
</head>
<body>  
    <div class="view">
    	<!-- 常见问题开始 -->
    	<div class="commonQueLayer" id="commonQueLayer"></div>
    	<!-- 常见问题结束 -->

    	<!-- 意见反馈开始 -->
		<div class="feedbackLayer">
			<form id="feedbackForm">
				<label class="MN_marginCtn MN_marginCtnRadio">
				<input type="radio" name="level" value="1" checked> 满意</label>
				<label class="MN_marginCtn MN_marginCtnRadio">
				<input type="radio" name="level" value="0"> 不满意</label>
				<div class="noSatiCtn">
					<p class="MN_marginCtn">您不满意的原因?</p>
					<label class="MN_marginCtnCheckbox"><input type="checkbox" name="reason[]" value="回答不准确"> 回答不准确</label>
					<label class="MN_marginCtnCheckbox"><input type="checkbox" name="reason[]" value="答非所问"> 答非所问</label>
					<label class="MN_marginCtnCheckbox"><input type="checkbox" name="reason[]" value="机器人骂人"> 机器人骂人</label>
				</div>
				<div class="MN_commentTipCtn">
					<textarea class="MN_commentCtn" id="commentCtn" name="content"></textarea>
				</div>
				<div class="MN_commentBtn" id="commentBtn">提交</div>
			</form>
		</div>
    	<!-- 意见反馈结束 -->

    	<!-- 留言开始 -->
		<div class="leaveMsgLayer">
			<form class="leaveMsgForm" id="leaveMsgForm">
				<textarea class="MN_commentCtn" id="leaveMsgCtn" name="content"></textarea>
				<input type="text" name="name" placeholder="姓名">
				<input type="text" name="telNum" placeholder="手机号码">
				<input type="text" name="qq" placeholder="QQ">
				<input type="text" name="webSite" placeholder="网址">
				<div class="leaveMsgBtn MN_commentBtn" id="leaveMsgBtn">提交</div>
			</form>
		</div>
    	<!-- 留言结束 -->

    	<!-- <div class="back">
    		<img class="logo" id="logo">
    		<p>网页由云问前端开发人员提供</p>
    	</div> -->
    	<div class="front">
                <!-- taskId:408 自如定制页面 头部由自如提供，此处隐藏
                     修改：删除显示机器人名称的标签 .hearName -->
			<div class="header-container hide">
                <div class="header">
                    <span class="backQuit" id="closeBtn"><i class="fa fa-angle-left"></i></span>
                    <div class="logo">
                        <img src="skin/h5chat_ZR/images/logo_ziru.png" alt="">
                    </div>
                    <span class="link"><i class="fa fa-commenting-o"></i></span>
                </div>
                
			</div>
    		<div class="chatScroll">
                <div class="chatCtn my-gallery" id="chatCtn" data-pswp-uid="1">

                </div>
                <!-- 用于存储满意度等级 -->
                <input type="hidden" id="helpLevel" value="-1">
            </div>
            
            <!-- TaskId:  408 自如页面定制 -->
            <!-- 原因：问题输入区域样式更改 -->
            <!-- 修改：去除发送按钮以及表情按钮，点击展开按钮后将隐藏的内容显示-->
    		<div class="editCtn">
                    <div class="editShow">
                        <!-- 表情按钮 -->
                        <div class="sendFaceBtn">
                                <span id="sendFace" class="sendFace faceBtn fa fa-smile-o"></span>
                        </div>

                        <div class="cosInput cosSome">
                            <div class="textareaCtn">
                                <textarea class="textarea" id="textarea" placeholder="没解决？问问木木吧"></textarea>
                            </div>
                            <!-- 使用图片上传功能时，该按钮不可注释 -->
                             <!--<div class="sendBtn sendMsg" id="sendBtn">发送</div>-->
                             <div class="sendBtnNew" id="sendBtnNew">发送</div>
                            <div class="addbtn">+</div>
                        </div>
                       
                    </div>
                    <div class="editHide">
                        <!-- 订单详情 -->
                        <div class="orderBtn editCtn_com">
                            <div class="btn-outer">
                              <span id="orderBtn" class="fa fa-file-text-o"></span>
                            </div>
                                <p class="MN_guideQue">我的合同</p>
                        </div>
                        <!-- 相片 -->
                        <div class="sendPicCtn editCtn_com">
                            <div class="btn-outer">
                                <span id="sendPic" class="sendPic"></span>
                            </div>
                            <p>相片</p>
                           
                        </div>
                        <!-- 拍照 -->
                        <div class="sendCameraCtn editCtn_com">
                            <div class="btn-outer">
                                <span id="sendCamera" class="sendCamera"></span>
                            </div>
                            <p>拍照</p>
                        </div>
                        <!-- 评价反馈 -->
                        <div class="feedbackCtn editCtn_com">
                            <div class="btn-outer">
                                <span id="sendFeedBack" class="fa fa-heart"></span>
                            </div>
                            <p>意见反馈</p>
                         </div>
                        <!-- <div class="sendFaceCtn editCtn_com">
                            <span id="sendFace" class="sendFace faceBtn"></span>
                        </div> -->


                        <!-- <div class="sendFileCtn editCtn_com">
                            <span id="sendFile" class="sendFile"></span>
                            &lt;!&ndash;<p>发送文件</p>&ndash;&gt;
                        </div> -->
                         <!-- <div class="takePhotoCtn editCtn_com">
                            <span class="takePhoto"></span>
                            &lt;!&ndash;<p>拍照发送</p>&ndash;&gt;
                        </div> -->
                        <!-- <div class="commonQueCtn editCtn_com">
                            <span id="sendCommonQue" class="commonQue"></span>
                            <p>常见问题</p>
                        </div> -->
                        <!-- <div class="feedbackCtn editCtn_com">
                            <span id="sendFeedBack" class="feedback"></span>
                            <p>意见反馈</p>
                        </div> -->
                      
                    </div>
                </div>
        </div>
    </div>
    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="pswp__bg"></div>
        <div class="pswp__scroll-wrap">
            <div class="pswp__container">
                <div class="pswp__item"></div>
                <div class="pswp__item"></div>
                <div class="pswp__item"></div>
            </div>
            <div class="pswp__ui pswp__ui--hidden">
                <div class="pswp__top-bar">
                    <div class="pswp__counter"></div>
                    <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                    <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                    <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                    <div class="pswp__preloader">
                        <div class="pswp__preloader__icn">
                            <div class="pswp__preloader__cut">
                                <div class="pswp__preloader__donut"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                    <div class="pswp__share-tooltip"></div>
                </div>
                <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
                </button>
                <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
                </button>
                <div class="pswp__caption">
                    <div class="pswp__caption__center"></div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
var tmpsourceId=3;
var initPhotoSwipeFromDOM = function(gallerySelector) {
        // 解析来自DOM元素幻灯片数据（URL，标题，大小...）
        var parseThumbnailElements = function(el) {
            var thumbElements = $(el).find('figure'),
                    numNodes = thumbElements.length,
                    items = [],
                    figureEl,
                    linkEl,
                    size,
                    item,
                    divEl,
                    nature;
            for(var i = 0; i < numNodes; i++) {
                figureEl = thumbElements[i]; // <figure> element
                // 仅包括元素节点
                if(figureEl.nodeType !== 1) {
                    continue;
                }
                divEl = figureEl.children[0];
                linkEl = divEl.children[0]; // <a> element
                nature = linkEl.children[0].naturalWidth+'x'+linkEl.children[0].naturalHeight;
                //size = linkEl.getAttribute('data-size').split('x');
                size = nature.split('x');
                // 创建幻灯片对象
                item = {
                    src: linkEl.getAttribute('href'),
                    w: parseInt(size[0], 10),
                    h: parseInt(size[1], 10)
                };
                if(figureEl.children.length > 1) {
                    item.title = figureEl.children[1].innerHTML;
                }
                if(linkEl.children.length > 0) {
                    // <img> 缩略图节点, 检索缩略图网址
                    item.msrc = linkEl.children[0].getAttribute('src');
                    item.src = linkEl.children[0].getAttribute('src');
                }
                item.el = figureEl; // 保存链接元素 for getThumbBoundsFn
                items.push(item);
            }
            return items;
        };

        // 查找最近的父节点
        var closest = function closest(el, fn) {
            return el && ( fn(el) ? el : closest(el.parentNode, fn) );
        };

        // 当用户点击缩略图触发
        var onThumbnailsClick = function(e) {
            e = e || window.event;
            //e.preventDefault ? e.preventDefault() : e.returnValue = false;
            var eTarget = e.target || e.srcElement;
            var clickedListItem = closest(eTarget, function(el) {
                return (el.tagName && el.tagName.toUpperCase() === 'FIGURE');
            });
            if(!clickedListItem) {
                return;
            }
            var clickedGallery = clickedListItem.parentNode,
                    childNodes = clickedListItem.parentNode.childNodes,
                    numChildNodes = childNodes.length,
                    nodeIndex = 0,
                    index;
            for (var i = 0; i < numChildNodes; i++) {
                if(childNodes[i].nodeType !== 1) {
                    continue;
                }
                if(childNodes[i] === clickedListItem) {
                    index = nodeIndex;
                    break;
                }
                nodeIndex++;
            }
            if(index >= 0) {
                openPhotoSwipe( index, clickedGallery );
            }
            return false;
        };

        var photoswipeParseHash = function() {
            var hash = window.location.hash.substring(1),
                    params = {};
            if(hash.length < 5) {
                return params;
            }
            var vars = hash.split('&');
            for (var i = 0; i < vars.length; i++) {
                if(!vars[i]) {
                    continue;
                }
                var pair = vars[i].split('=');
                if(pair.length < 2) {
                    continue;
                }
                params[pair[0]] = pair[1];
            }
            if(params.gid) {
                params.gid = parseInt(params.gid, 10);
            }
            return params;
        };

        var openPhotoSwipe = function(index, galleryElement, disableAnimation, fromURL) {
            var pswpElement = document.querySelectorAll('.pswp')[0],
                    gallery,
                    options,
                    items;
            items = parseThumbnailElements(galleryElement);
            // 这里可以定义参数
            options = {
                barsSize: {
                    top: 100,
                    bottom: 100
                },
                fullscreenEl : false,
                shareButtons: [
                    {id:'wechat', label:'分享微信', url:'#'},
                    {id:'weibo', label:'新浪微博', url:'#'},
                    {id:'download', label:'保存图片', url:'{{raw_image_url}}', download:true}
                ],
                galleryUID: galleryElement.getAttribute('data-pswp-uid'),
                getThumbBoundsFn: function(index) {
                    var thumbnail = items[index].el.getElementsByTagName('img')[0], // find thumbnail
                            pageYScroll = window.pageYOffset || document.documentElement.scrollTop,
                            rect = thumbnail.getBoundingClientRect();
                    return {x:rect.left, y:rect.top + pageYScroll, w:rect.width};
                }
            };
            if(fromURL) {
                if(options.galleryPIDs) {
                    for(var j = 0; j < items.length; j++) {
                        if(items[j].pid == index) {
                            options.index = j;
                            break;
                        }
                    }
                } else {
                    options.index = parseInt(index, 10) - 1;
                }
            } else {
                options.index = parseInt(index, 10);
            }
            if( isNaN(options.index) ) {
                return;
            }
            if(disableAnimation) {
                options.showAnimationDuration = 0;
            }
            gallery = new PhotoSwipe( pswpElement, PhotoSwipeUI_Default, items, options);
            gallery.init();
        };

        var galleryElements = document.querySelectorAll( gallerySelector );
        for(var i = 0, l = galleryElements.length; i < l; i++) {
            galleryElements[i].setAttribute('data-pswp-uid', i+1);
            galleryElements[i].onclick = onThumbnailsClick;
        }
        var hashData = photoswipeParseHash();
        if(hashData.pid && hashData.gid) {
            openPhotoSwipe( hashData.pid ,  galleryElements[ hashData.gid - 1 ], true, true );
        }
    };

    initPhotoSwipeFromDOM('.my-gallery');
    /**
      * taskId=370;赵永平
      * 原因：在ios上键盘会遮住input输入框
      * 修改：点击后触发延迟100ms 后调用scrollIntoView解决
      */
    var timer1;  
    $('#textarea').on('focus',function() {
      var self = this;
      timer1 = setTimeout(function() {
        self.scrollIntoView(false);
      },100)
    });

    $('#textarea').on('blur',function() {
      if(timer1){
        clearInterval(timer1);  
      }
    });
    // /*taskId=447 点击显示更多，跳转自如*/

    var _paramsArr = [
        //跳转到合同列表
        {
            flag:true,
            type:"参数",
            ele:".f0",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeContract.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //我的保洁
        {
            flag:true,
            type:"参数",
            ele:".f1",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeDailycleaningOrderList.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //预约双周保洁
        {
            flag:true,
            type:"参数",
            ele:".f2",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeFortnight.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //预约日常保洁
        {
            flag:true,
            type:"参数",
            ele:".f3",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeDailycleaning.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //预约消杀保洁
        {
            flag:true,
            type:"参数",
            ele:".f4",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeXiaoSha.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //预约深度保洁
        {
            flag:true,
            type:"参数",
            ele:".f5",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeShendu.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //预约开荒保洁
        {
            flag:true,
            type:"参数",
            ele:".f6",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeKaihuang.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //预约搬家
        {
            flag:true,
            type:"参数",
            ele:".f7",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeHousemoving.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //我的搬家
        {
            flag:true,
            type:"参数",
            ele:".f8",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeHousemovingOrderList.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //在线报修
        {
            flag:true,
            type:"参数",
            ele:".f9",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeRepair.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //我的报修
        {
            flag:true,
            type:"参数",
            ele:".f10",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeRepairOrderList.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //宽带报修
        {
            flag:true,
            type:"参数",
            ele:".f11",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeKuanDai.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //我的管家
        {
            flag:true,
            type:"参数",
            ele:".f12",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeHousekeeper.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //智能门锁
        {
            flag:true,
            type:"参数",
            ele:".f13",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeIintelligentlock.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        },
        //投诉反馈
        {
            flag:true,
            type:"参数",
            ele:".f14",  //元素class 只能用class选择，当这个元素click的时候就会执行交互
            fn:"http://ZRQuestionDetailLinkToUrlTypeSuggestions.ziroom.com",
            params:{},
            callback:"",
            oldCallback:function(){

            }
        }
    ];

    ZIROOMApp.initApp(_paramsArr);

</script>
</html>