<!DOCTYPE html>
<!--[if IE 8]>
<html lang="en" class="ie8"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->

<head>
    <meta charset="utf-8"/>
    <title>第三方知识系统回答</title>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/>
    <meta content="" name="description"/>
    <meta content="" name="author"/>

    <!-- ================== BEGIN BASE CSS STYLE ================== -->
    <link href="../../assets/plugins/jquery-ui/themes/base/minified/jquery-ui.min.css" rel="stylesheet"/>
    <link href="../../assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="../../assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="../../assets/css/animate.min.css" rel="stylesheet"/>
    <link href="../../assets/css/style.min.css" rel="stylesheet"/>
    <link href="../../assets/plugins/gritter/css/jquery.gritter.css" rel="stylesheet"/>
    <link href="../../assets/css/style-responsive.min.css" rel="stylesheet"/>
    <link href="../../assets/css/theme/default.css" rel="stylesheet" id="theme"/>
    <link href="../../assets/plugins/bootstrap-datepicker/css/datepicker.css" rel="stylesheet"/>
    <!-- ================== END BASE CSS STYLE ================== -->
    <link href="../../assets/plugins/bootstrap-datetimepicker/css/datetimepicker.css" rel="stylesheet"/>
    <link rel="stylesheet" href="../common/css/radioskin/blue.css">
    <link rel="stylesheet" href="../common/css/zTreeStyleTest.css">
    <link href="../../assets/plugins/lightbox/css/lightbox.css" rel="stylesheet"/>
    <link href="css/style.css" rel="stylesheet"/>
    <link href="../common/css/customChatLog.css" rel="stylesheet">
    <style>
        #tm1, #tm2 {
            cursor: pointer;
        }

        .chats .image {
            width: 30px;
            height: 30px;
        }

        .btn .caret {
            margin-left: 4px;
        }

        @media screen and (max-width: 1300px) {
            .aa {
                margin-top: 5px;
            }
        }

        @media screen and (max-width: 1215px) {
            #timeSearchForm {
                margin-top: 5px;
            }
        }

        @media screen and (max-width: 1200px) {
            .toShow {
                width: 25%;
                float: left;
            }

            .toHide {
                width: 75%;
                float: left;
            }

            #timeSearchForm .row {
                float: left;
                margin-bottom: 20px;
            }
        }

        .nav-tabs > li.active > a,
        .nav-tabs > li.active > a:hover,
        .nav-tabs > li.active > a:focus {
            color: #fff;
            background-color: #348fe2;
            border: 1px solid #348fe2 !important;
            border-radius: 2px;
        }

        .nav-tabs > li > a {
            margin-right: 5px;
            line-height: 20px;
            padding: 7px 15px;
            background-color: #b6c2c9;
            border: 1px solid #b6c2c9 !important;
            border-top-left-radius: 3px;
            border-top-right-radius: 3px;
            color: #fff;
            font-size: 14px;
        }

        .tbshow.tbhide {
            display: none;
        }

        .table img {
            max-width: 200px;
        }

        .ccca {
            padding: 5px;
        }

        .ccca:not(:first-child) {
            border-top: 1px solid #e2e7eb;
        }

        @media (max-width: 1217px) {
            .form-horizontal .hideForm {
                margin-left: 0;
                margin-right: 0;
            }

        }

        @media (max-width: 991px) {
            #qualityForm .col-md-3 {
                padding-right: 0;
                padding-left: 0;
            }

            #qualityForm .col-md-6 {
                padding-left: 0;
            }
        }
    </style>
</head>

<body>
<div class="modal fade" style="display: none;" aria-hidden="true" id="dandianModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body" id="myfather"></div>
            <div class="modal-footer">
                <button id="ensureCos" type="submit" class="btn btn-sm btn-primary" href="javascript:;">确定</button>
                <a data-dismiss="modal" class="btn btn-sm btn-white" href="javascript:;">取消</a>
            </div>
        </div>
    </div>
</div>

<!-- #modal-dialog -->
<!--确认删除模态框-->
<div id="makeSure" class="modal" style="display:none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">确定清空？</h4>
            </div>
            <div class="modal-body">
                <p>确定要清空所有无意义的内容？</p>
            </div>
            <div class="modal-footer">
                <a href="javascript:;" class="btn btn-sm btn-primary" id="ok">确认</a>
                <a href="javascript:;" class="btn btn-sm btn-white" id="cancel">取消</a>
            </div>
        </div>
    </div>
</div>
<!--回答问题模态框-->
<div class="modal" id="modal-dialog-ans" style="z-index:40;">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">回答问题</h4>
            </div>
            <div class="modal-body">
                <form>
                    <fieldset>
                        <div class="form-group">
                            <label class="control-label">问题</label>
                            <div style="padding-left:0;padding-right:0;">
                                <input type="text" class="form-control" name="ansQueInput662">
                            </div>
                        </div>
                    </fieldset>
                </form>
                <div>
                    <div style="position:relative;">
                        <div class="classifyCtn">
                            <div class="queCtn m-b-10" style="display: inline-block;">
                                <div>
                                    <label class="control-label">选择分类：</label>
                                    <a class="selectQue" style="cursor:pointer;">全部分类</a>
                                </div>
                                <div id="ztree2" class="ztree" style="z-index: 101;display:none;"></div>
                            </div>
                            <div class="fromCtn channelCtn">
                                <label class="control-label">选择生效渠道：</label>
                                <div class="channel" style="display: inline-block;"></div>
                            </div>
                            <div class="fromCtn roleCtn m-t-10">
                                <label class="control-label">选择来访者角色：</label>
                                <div style="display: inline-block;">
                                    <span class="openAll3 glyphicon glyphicon-plus-sign" style="cursor:pointer;" title="展开所有"></span>
                                    <span class="closeAll3 glyphicon glyphicon-minus" style="cursor:pointer;" title="折叠所有"></span>
                                </div>
                                <div id="ztree3" class="ztree" style="position: relative;display: inline-block;vertical-align: middle;"></div>
                            </div>
                        </div>
                        <div class="showCtn form-group" style="margin-top: 20px;">
                            <div class="">
                                <textarea id="ans-textarea" placeholder="请输入您的回答" rows="5"></textarea>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <div class="modal-footer modal-footer1 modal-footer2">
                <a href="javascript:;" class="ansAndLearn btn btn-sm btn-primary">回答并学习</a>
                <a href="javascript:;" class="btn btn-sm btn-white" data-dismiss="modal">关闭</a>
            </div>
        </div>

    </div>
</div>

<div class="modal" style="display: none;" aria-hidden="true" id="chatModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
                <h4 class="modal-title">查看记录</h4>
            </div>
            <div class="modal-body p-b-0 p-t-5">
                <div class="row-fluid sendCheck" style="display: none;">
                    <div class="row">
                        <form id="qualityForm">
                            <input type="hidden" name="uuid">
                            <input type="hidden" name="chatVersion">
                            <input type="hidden" name="chatlogId">
                            <label class="bold">问题</label>
                            <input type="text" placeholder="问题" class="col-md-12 form-control" name="formatQue"
                                   style="margin-bottom: 10px;">
                            <div style="padding-left: 0" class="col-md-3">
                                质检类型 <b class="red">*</b>
                                <select name="qualityModeId" class="col-md-12 form-control" style="padding: 6px; height: 34px;margin-bottom: 10px;"></select>
                                <input type="hidden" name="recheckModeId">
                            </div>
                            <div class="col-md-3">
                                质检评分
                                <input type="text" placeholder="质检评分" class="col-md-12 form-control" name="score" style="margin-bottom: 10px;">
                            </div>
                            <div class="col-md-6" style="padding-right:0px">
                                质检评语
                                <input type="text" placeholder="质检评语" class="col-md-12 form-control" name="qualityContent" style="resize: none; height: 34px;margin-bottom: 10px;">
                            </div>
                        </form>
                    </div>


                    <div class="row">
                        <ul class="nav nav-pills nav-pills-chg">
                            <li status="1" class="active"><a href="#navChatLogOne" data-toggle="tab" aria-expanded="true">已有答案回答</a></li>
                            <li status="2"><a href="#navChatLogTwo" data-toggle="tab" aria-expanded="false">编辑答案回答</a>
                            </li>
                        </ul>
                        <!--切换的内容-->
                        <div style="padding: 0" class="tab-content">

                            <!-- 点击切换2-->
                            <div class="tab-pane active" id="navChatLogOne">
                                <form id="nav-pills-tab-2-form">
                                    <input type="hidden" name="pageNo" value="1">
                                    <input type="hidden" name="isLeaf" value="1">
                                    <input type="hidden" name="status" value="0">
                                    <input type="hidden" name="level" value="1">
                                    <input type="hidden" name="pageSize" value="5">
                                    <input type="hidden" id="tab2quetype" name="queryType" value="1">
                                    <div class="row">
                                            <span class="col-md-5">选择分类：
                                                <a href="#" class="ztreeName2">全部分类</a>
                                                <input type="hidden" name="groupId" value="0">
                                            </span>

                                        <div class="ztree tanchu" id="tanchutree2"
                                             style="display: none;margin-top: 15px"></div>
                                        <div class="input-group col-md-4 pull-right">
                                            <input type="text" class="form-control" id="tab2que" name="question">
                                            <div class="input-group-btn">
                                                <ul class="dropdown-menu pull-right">
                                                    <li><a href="javascript:;"
                                                           onclick="$('#tab2que').attr('name', 'question');$('#tab2quetype').val('1');">问题</a>
                                                    </li>
                                                    <li><a href="javascript:;"
                                                           onclick="$('#tab2que').attr('name', 'answer');$('#tab2quetype').val('2');">答案</a>
                                                    </li>
                                                </ul>
                                                <button type="button"
                                                        class="btn-toggle btn btn-primary dropdown-toggle curHtml"
                                                        data-toggle="dropdown" aria-haspopup="true"
                                                        aria-expanded="false">问题<span class="caret"></span>
                                                </button>
                                                <button type="button" class="btn btn-primary searchHasAns">
                                                    <i class="glyphicon glyphicon-search"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                                <div class="max370">
                                    <table class="table" style="width:100%;margin: 10px 0">
                                        <thead>
                                        <tr>
                                            <td width="50"></td>
                                            <th>问题</th>
                                            <th id="gggggggg">答案</th>
                                            <th width="160">时间</th>
                                        </tr>
                                        </thead>
                                        <tbody class="tbody2"></tbody>
                                    </table>
                                </div>
                                <div id="itemContainer_ask" style="margin-bottom: -20px;"></div>
                            </div>

                            <!-- 点击切换3-->
                            <div class="tab-pane " id="navChatLogTwo">
                                <div class="col-md-12">
                                    <div class="row mb10">
                                            <span class="col-md-12" style="padding-left: 0;">问题分类<b class="red">*</b>：
                                                <a class="ztreeName3" href="javascript:;">全部分类</a>
                                                <input type="hidden" name="groupId" value="0">
                                            </span>
                                        <div class="ztree tanchu" id="tanchutree3"
                                             style="display: none;margin-top: 15px"></div>
                                    </div>

                                    <div class="row mb10" id="warpRoles">
                                        <span>生效角色：</span>&nbsp;&nbsp;
                                        <a id="juese" href="#QuestionClassModel" data-toggle="modal">来访者角色</a>
                                    </div>
                                    <div class="row mb10" id="warpRules">
                                        <div class="col-md-2" style="margin-left: -10px;width: 88px;margin-top:10px;">
                                            <span>生效渠道：</span>&nbsp;
                                        </div>
                                        <div class="col-md-10" style="margin-left:-20px;">
                                            <div id="chooseAll"></div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <span>输入答案<b class="red">*</b>：</span>
                                    </div>
                                    <div style="padding: 0" class="row">
                                        <textarea class="form-control" id="insert" maxlength="200" cols="150" rows="5"
                                                  name="title"></textarea>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <!-- 底部3按钮-->
                        <div style="position: absolute;bottom: 15px;right:30px" class="row">
                            <a href="javascript:;" class="cancel btn btn-sm btn-white">取消</a>
                            <a href="javascript:;" class="testOnly btn btn-sm btn-primary">仅质检</a>
                            <button class="testAndlearn btn btn-sm btn-white btn-primary">质检并学习</button>
                        </div>
                    </div>
                </div>
                <form method="POST" id="visiterForm" class="form-horizontal">
                    <fieldset>
                        <div class="form-group m-b-5">
                            <label class="col-md-2 control-label">访客信息</label>
                            <div class="col-md-9" style="padding-left:15px;padding-right:15px;padding-top:7px;">
                                <span class="visiterInfo"></span>
                                <button type="button" class="btn btn-primary btn-xs" onclick="$('.hideForm').toggle();">
                                    高级查询
                                </button>
                            </div>
                        </div>
                        <div class="form-group hideForm m-b-5" style="display: none;">
                            <label class="col-md-2 control-label">起始时间</label>
                            <div class="col-md-3" style="padding-left:0;padding-right:0;">
                                <input size="16" type="text" readonly class="form-control form_datetime input-sm"
                                       name="startTime">
                            </div>
                            <label class="col-md-2 control-label">结束时间</label>
                            <div class="col-md-3" style="padding-left:0;padding-right:0;">
                                <input size="16" type="text" readonly class="form-control form_datetime input-sm"
                                       name="endTime">
                            </div>
                        </div>
                        <div class="form-group hideForm m-b-5" style="display: none;">
                            <label class="col-md-2 control-label">内容</label>
                            <div class="col-md-8" style="padding-left:0;padding-right:0;">
                                <input type="text" class="form-control input-sm" name="content">
                            </div>
                        </div>
                        <div class="form-group hideForm" style="display: none;">
                            <label class="col-md-2 control-label"></label>
                            <div class="col-md-8" style="padding-left:0;padding-right:0;">
                                <a href="javascript:void(0);" title="本次记录" class="bcjl btn btn-primary btn-xs">本次记录</a>
                                <a href="javascript:void(0);" title="全部记录" class="qbjl btn btn-primary btn-xs">全部记录</a>
                                <button type="button" class="btn btn-primary btn-xs" id="searchChatRe">搜索</button>
                                <button type="button" class="btn btn-primary btn-xs" onclick="searchClear()">清空</button>
                            </div>
                        </div>
                        <input type="hidden" class="recordsChatUserId" name="chatUserId">
                        <input type="hidden" class="tempValue">
                        <input type="hidden" class="chatV" name="chtvs">
                        <input type="hidden" class="locateContent" name="locateContent">
                    </fieldset>
                </form>
                <div id="chatCon">
                    <div id="chatLogList">
                        <ul class="chats"></ul>
                    </div>
                </div>
                <div id="chatpageList" style="margin-top:10px; margin-bottom:0px;"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
<div id="page-container" class="fade in">
    <div id="content" class="content">
        <!-- begin breadcrumb -->
        <ol class="breadcrumb pull-right">
            <li><a href="javascript:;">首页</a></li>
            <li><a href="javascript:;">知识库管理</a></li>
            <li>第三方知识系统回答</li>
        </ol>
        <!-- end breadcrumb -->
        <!-- begin page-header -->
        <h1 class="page-header">第三方知识系统回答</h1>
        <!-- end page-header -->

        <!-- begin row -->
        <div class="rowNav">
            <!-- begin col-12 -->
            <div>
                <!-- begin panel -->
                <div class="panel panel-inverse" data-sortable-id="table-basic-7">
                    <div class="panel-body">
                        <form id="timeSearchForm" class="form-inline m-b-15">
                            <div class="row">
                                <div class="pull-right">
                                    <div class="btn-group">
                                        <div class="input-group" style="width:250px; margin-right:-11px;">
                                            <input type="text" class="search-input-addSrc form-control"placeholder="输入搜索的词">
                                            <span class="search-addSrc input-group-btn"style="padding-bottom: 0;">
                                                <button style="border-top-right-radius:3px;border-bottom-right-radius:3px;"class="btnSearch btn btn-primary" type="button">
                                                    <i class="glyphicon glyphicon-search"></i>
                                                </button>
                                                <button class="btn btn-default hide" onclick="$('#timeSearchForm')[0].reset()"type="button" style="">
                                                    <i class="glyphicon glyphicon-remove"></i>
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="btn-group" style="margin-right:1px;">
                                        <button id="myDropdown" type="button"
                                                class="ttw btn-toggle btn btn-primary dropdown-toggle"
                                                aria-haspopup="true" aria-expanded="false">最近七天<span
                                                class="caret"></span></button>
                                        <ul class="dropdown-menu" style="min-width: 275px;">
                                            <li><a class="ttw0" data-p="" href="#">昨天</a></li>
                                            <li><a class="ttw1" data-p="" href="#">今天</a></li>
                                            <li><a class="ttw2" data-p="" href="#">最近七天</a></li>
                                            <li><a class="ttw3" data-p="" href="#">最近一个月</a></li>
                                            <li><a class="ttw4" data-p="" href="#">全部时间</a></li>
                                            <li style="height: 120px; padding-top: 10px;margin-top: 10px;border-top: 1px solid #e2e7e8;">
                                                <span style="margin-left: 15px">自定义时间范围：</span>
                                                <div style="text-align: center">
                                                    <input id="tm1" size="16" type="text" readonly class="form-control form_datetime m-2 input-sm" name="startT">
                                                    <input id="tm2" size="16" type="text" readonly class="form-control form_datetime m-2 input-sm" name="endT">
                                                </div>
                                                <div style="padding-top: 10px;margin-top: 4px;border-top: 1px solid #e2e7e8;" class="text-center ">
                                                    <button style="width:97%;" class="btn confirm btn-primary" type="button" onclick="$('#myDropdown').parent().removeClass('open');initSrc(1);">确认</button>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="btn-group" role="group" aria-label="...">
                                        <button type="button" class="btn-toggle btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            批量处理<span class="caret"></span>
                                        </button>
                                        <ul class="dropdown-menu" style="min-width: 125px; left: 0; right: auto;">
                                            <li><a class="mult-ig" href="#">批量忽略</a></li>
                                            <li><a class="ansOneTime" href="#">合并回答</a></li>
                                        </ul>
                                    </div>
                                    <div class="btn-group solve_status" role="group" aria-label="...">
                                        <button type="button" class="btn-toggle btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            全部处理状态<span class="caret"></span>
                                        </button>
                                        <ul class="dropdown-menu" style="min-width: 125px; left: auto; right: 0;">
                                            <li><a class="status" href="#" data-status="-1">全部处理状态</a></li>
                                            <li><a class="status" href="#" data-status="4">未接收</a></li>
                                            <li><a class="status" href="#" data-status="3">未处理</a></li>
                                            <li><a class="status" href="#" data-status="2">编辑处理</a></li>
                                            <li><a class="status" href="#" data-status="1">忽略处理</a></li>
                                        </ul>
                                    </div>
                                    <div class="btn-group">
                                        <button type="button"
                                                class="sort0_0 btn-toggle btn btn-primary dropdown-toggle"
                                                data-toggle="dropdown" aria-haspopup="true"
                                                aria-expanded="false"
                                                style="border-radius: 3px; border-left-color: transparent;">排序方式<span
                                                class="caret"></span></button>
                                        <ul class="dropdown-menu" style="min-width: 125px;">
                                            <li><a class="sort1" href="#">默认排序</a></li>
                                            <li><a class="sort2" href="#">时间正序</a></li>
                                            <li><a class="sort3" href="#">时间倒序</a></li>
                                        </ul>
                                    </div>
                                    <div id="DataSource" class="btn-group"
                                         style="cursor:pointer; margin-right:1px;" role="group"
                                         aria-label="...">
                                        <a class="sourceType btn btn-toggle dropdown-toggle btn-primary"
                                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">全部渠道<span
                                                class="caret"></span></a>
                                        <ul class="dropdown-menu pull-right" id="DataSourceUL">
                                            <li><a class="sol" href="#">全部渠道</a></li>
                                            <li><a class="sol" href="#">网页</a></li>
                                            <li><a class="sol" href="#">微信</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </form>
                        <div class="" style="padding-right: 0;">
                            <table class="table table1" style="margin-top: 0px;" id="tb01">
                                <thead>
                                <tr>
                                    <th width="45"><input class="multCos" type="checkbox"></th>
                                    <th>问题</th>
                                    <th>渠道</th>
                                    <th>分类</th>
                                    <th>时间</th>
                                    <th>第三方系统</th>
                                    <th>处理状态</th>
                                    <th width="90">操作</th>
                                </tr>
                                </thead>
                                <tbody class="dsf_knowledge_tbody">
                                </tbody>
                            </table>
                            <div id="itemContainer"></div>
                        </div>
                    </div>
                </div>
                <!-- end panel -->

            </div>
            <!-- end col-12 -->
            <!-- end row -->
        </div>
        <!-- end row -->
    </div>
    <!-- begin scroll to top btn -->
    <a href="javascript:;" class="btn btn-icon btn-circle btn-success btn-scroll-to-top fade" data-click="scroll-top"><i
            class="fa fa-angle-up"></i></a>
    <!-- end scroll to top btn -->
</div>
<!-- ================== BEGIN BASE JS ================== -->
<script src="../../assets/plugins/jquery/jquery-1.9.1.min.js"></script>
<script src="../../assets/plugins/jquery/jquery-migrate-1.1.0.min.js"></script>
<script src="../../assets/plugins/jquery-ui/ui/minified/jquery-ui.min.js"></script>
<script src="../../assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<!--[if lt IE 9]>
<script src="../../assets/crossbrowserjs/html5shiv.js"></script>
<script src="../../assets/crossbrowserjs/respond.min.js"></script>
<script src="../../assets/crossbrowserjs/excanvas.min.js"></script>
<![endif]-->
<script src="../../assets/plugins/slimscroll/jquery.slimscroll.min.js"></script>
<!-- ================== END BASE JS ================== -->

<!-- ================== BEGIN PAGE LEVEL JS ================== -->
<script src="../../assets/js/apps.min.js"></script>
<!-- ================== END PAGE LEVEL JS ================== -->

<!-- 必加开始 -->
<script src="../../assets/plugins/gritter/js/jquery.gritter.js"></script>
<script src="../../assets/plugins/lightbox/js/lightbox-2.6.min.js"></script>
<script src="../../assets/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script src="../../assets/plugins/slimscroll/jquery.slimscroll.min.js"></script>
<script src="../common/js/bootstrap-datetimepicker.zh-CN.js"></script>
<script src="../common/js/bootstrap-paginator.js"></script>
<script src="../common/js/icheck.js"></script>
<script src="../common/js/jquery.ztree.all-3.5.js"></script>
<script src="../../assets/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script src="../common/js/customMethod.js"></script>
<script src="../common/js/iframeTab.min.js"></script>
<!--编辑器-->
<script type="text/javascript" src="../common/js/ueditor/ueditor.config.js"></script>
<script type="text/javascript" src="../common/js/ueditor/ueditor.all.js"></script>
<script type="text/javascript" src="../common/js/ueditor/lang/zh-cn/zh-cn.js"></script>
<script src="../common/js/base.js"></script>
<script src="js/main.js"></script>
<script src="../common/js/customChatLog.js"></script>
<!-- 必加结束 -->

<script>
    /*==========全局变量==========*/
    var pageNo = 1;
    var pageSize = 30;
    var startTime = '';
    var endTime = '';
    var orderType = 1;
    var source = -1;
    var status = '';
    var question = '';

    var ids = [];

    var queryStr = '?question=';
    var pageNo2 = 1;
    var pageSize2 = 30;
    var groupId = 0;
    var isLeaf = 1;
    var status2 = 0;
    var level = 1;
    var answer = '';

    var isIgnore = true;

    $(document).ready(function () {
        App.init();

        apply();
        ansQue();
    });

    /*==========日期选择下拉菜单=========*/
	$('.confirm').click(function(){
		$('#myDropdown').parent().removeClass('open');
		$('.btnSearch').trigger('click');
	});
    //全局变量 获得当前时间
    var myDate = new Date();
    var myDateM = myDate.getMonth()+1;//月
    var myDateD = myDate.getDate();//日
    var myDateHou = myDate.getHours();//时
    var myDateMin = myDate.getMinutes()+2;//分

    function updateTime(){
        myDate = new Date();
        myDateM = myDate.getMonth()+1;//月
        myDateD = myDate.getDate();//日
        myDateHou = myDate.getHours();//时
        myDateMin = myDate.getMinutes()+2;//分
    }

    if(myDateM<10){//判断现在月份格式
        myDateM = "0"+myDateM;
    }
    if(myDateD<10){//判断现在日期格式
        myDateD = "0"+myDateD;
    }
    if(myDateHou<10){//判断现在小时格式
        myDateHou = "0"+myDateHou;
    }
    if(myDateMin<10){//判断现在分钟格式
        myDateMin = "0"+myDateMin;
    }
    //页面初始化 默认一周自动填充时间
    function  apply(){//获取一周前时间
        var newDatew = new Date();
        newDatew.setTime(new Date()-7*24*60*60*1000);//此时newDatew变成了一周前的时间
        var weekMon = newDatew.getMonth()+1;//一周前的月份
        if(weekMon<10){weekMon='0'+(newDatew.getMonth()+1)};
        var weekDay = newDatew.getDate();//一周前的日
        if(weekDay<10){weekDay='0'+newDatew.getDate()};
        var week = newDatew.getFullYear()+"-" + weekMon + "-" + weekDay;
        $('#tm1').val(week+' '+myDateHou+':'+myDateMin);//一周前的现在
        $('#tm2').val(myDate.getFullYear()+'-'+myDateM+'-'+myDateD+' '+myDateHou+':'+myDateMin);//今天的时间
        initSrc();
    }

    //获得上月今天的方法
    function lastMonthDate(){
        var vYear = myDate.getFullYear();
        var vMon = myDate.getMonth() + 1;
        var vDay = myDate.getDate();
        //每个月的最后一天日期（为了使用月份便于查找，数组第一位设为0）
        var daysInMonth = new Array(0,31,28,31,30,31,30,31,31,30,31,30,31);
        if(vMon==1){
            vYear = myDate.getFullYear()-1;
            vMon = 12;
        }else{
            vMon = vMon -1;
        }
        //若是闰年，二月最后一天是29号
        if(vYear%4 == 0 && vYear%100 != 0){
            daysInMonth[2]= 29;
        }
        if(daysInMonth[vMon] < vDay){
            vDay = daysInMonth[vMon];
        }
        if(vDay<10){
            vDay="0"+vDay;
        }
        if(vMon<10){
            vMon="0"+vMon;
        }
        var LastMonthDate =vYear+"-"+ vMon +"-"+vDay;
        return LastMonthDate;
    }

    //点击弹出下拉菜单
    $('#myDropdown').on('click', function () {
        $(this).parent().toggleClass('open');
    });
    $('body').on('click', function (e) {
        if(!$('#myDropdown').parent().find($(e.target)).length) {
            $('#myDropdown').parent().removeClass('open');
        }
    });
    $('.ttw0').on('click', function() { //昨天
        updateTime();
        $('#myDropdown').parent().removeClass('open');
        $('.ttw').html($(this).text() + '<span class="caret"></span>');
        var newDate1 = new Date();//获取当前时间
        newDate1.setTime(newDate1.getTime()-24*60*60*1000);//当前时间设置成昨天时间
        var yestM = newDate1.getMonth()+1; //昨天的月
        if(yestM<10){
            yestM ="0"+yestM;
        }
        var yestD = newDate1.getDate();//昨天的日
        if(yestD<10){
            yestD="0"+yestD;
        }
        pageNo = 1;
        var yesterday = newDate1.getFullYear()+"-" + yestM + "-" + yestD;
        $('.ttw').html($(this).text() + '<span class="caret"></span>');
        $('#tm1').val(yesterday+' '+'00'+':'+'00');//昨天的时间
        $('#tm2').val(new Date().getFullYear()+'-'+myDateM+'-'+myDateD+' '+'00'+':'+'00');//现在的时间
        initSrc();
    });
    $('.ttw1').on('click', function() { //今天
        updateTime();
        $('#myDropdown').parent().removeClass('open');
        $('.ttw').html($(this).text() + '<span class="caret"></span>');
        pageNo = 1;
        $('#tm1').val(myDate.getFullYear()+'-'+myDateM+'-'+myDateD+' '+'00'+':'+'00');//今天零点
        $('#tm2').val(myDate.getFullYear()+'-'+myDateM+'-'+myDateD+' '+myDateHou+':'+myDateMin);//现在时间
        initSrc();
    });
    $('.ttw2').on('click', function() { //最近七天
        updateTime();
        $('#myDropdown').parent().removeClass('open');
        $('.ttw').html($(this).text() + '<span class="caret"></span>');
        apply();
    });
    $('.ttw3').on('click', function() { //最近一个月
        updateTime();
        $('#myDropdown').parent().removeClass('open');
        $('.ttw').html($(this).text() + '<span class="caret"></span>');
        pageNo = 1;
        $('#tm1').val(lastMonthDate()+' '+myDateHou+':'+myDateMin);//一月前的今天
        $('#tm2').val(new Date().getFullYear()+'-'+myDateM+'-'+myDateD+' '+myDateHou+':'+myDateMin);//现在时间
        initSrc();
    });
    $('.ttw4').on('click', function() { //全部
        updateTime();
        $('#myDropdown').parent().removeClass('open');
        $('.ttw').html($(this).text() + '<span class="caret"></span>');
        pageNo = 1;
        $('#tm1').val('');
        $('#tm2').val('');
        initSrc();
    });

    /*==========排序==========*/
    $('.sort1').on('click', function() { //默认
        $('.sort0_0').html($(this).text() + '<span class="caret"></span>');
        orderType = 1;
        pageNo = 1;
        initSrc();
    });
    $('.sort2').on('click', function() { //时间正序
        $('.sort0_0').html($(this).text() + '<span class="caret"></span>');
        orderType = 1;
        pageNo = 1;
        initSrc();
    });
    $('.sort3').on('click', function() { //时间倒序
        $('.sort0_0').html($(this).text() + '<span class="caret"></span>');
        orderType = 2;
        pageNo = 1;
        initSrc();
    });

    /*==========批量处理==========*/
    $('body').on('click', '.mult-ig', function() {
        pageNo = 1;
        if ($(this).is('.mult-ig')) { //批量忽略
            var ids = [];
            //isIgnore = true;
            $('.singleCos').each(function() {
                var $tr = $(this).parents('tr'),
                    id = $tr.attr('Id'),
                    status = $tr.attr('statusType');

                /*if(status != '忽略处理'){
                    isIgnore = false;
                }*/

                if ($(this).is(':checked')) {
                    ids.push(id);
                }
            });

            /*if(isIgnore == false){
                Base.gritter('当前问题不是忽略处理状态！', false);
                return;
            }*/
            ignoreWhich = 'doIgnoreQues'; // #1
            window.$obj = ids.toString();
            var message = {
                title:'确认删除？',
                content:'删除该问题将一并删除答案与相似问法，确认删除该问题吗？'
            };

            Base.request({
                url: 'ThirdKnowledgeSystem/deleteByIds',
                params: {
                    ids: ids.toString(),
                },
                callback: function (data) {
                    if (data.status) {
                        var msg = data.message;
                        if (msg == '参数异常！') {
                            msg = '勾选要忽略的问题';
                        }
                        Base.gritter(msg, false);
                    } else {
                        $(this).adcCreator(function() {
                            Base.gritter(data.message, true);
                            if ($('.ig').length == ids.length) {
                                if (pageNo >= 2) {
                                    pageNo -= 1;
                                }
                            }
                            initSrc();
                        },{},message);
                    }
                },
            });

        }
    });
    //合并回答
    $('.ansOneTime').on('click', function() {
        ids = [];
        var answer1 = [];
        isIgnore = true;
        $('.singleCos:checked').each(function() {
            var $tr = $(this).parents('tr'),
                id = $tr.attr('queid'),
                status = $tr.attr('statusType');

            if(status != '忽略处理'){
                isIgnore = false;
            }

            if ($(this).is(':checked')) {
                ids.push(id);
                answer1.push($tr.find('td:eq(1)').text());
            }
        });
        if(isIgnore == false){
            Base.gritter('当前问题不是忽略处理状态！', false);
            return;
        }
        ids = ids.toString();
        if (ids) {
            $('#modal-dialog-ans').modal('show');
            $('input[name=ansQueInput662]').val(answer1);
            answer = '';
            ansQue();
        } else {
            Base.gritter('选择您要合并的回答', false);
        }
    });

    /*==========回答==========*/
    //调出回答
    $('body').on('click', '.ans', function() {
        var treeObj = $.fn.zTree.getZTreeObj("ztree2");

        var $tr = $(this).parents('tr'),
            answer1 = $tr.find('td:eq(1)').text();

        ids = $tr.attr('queid');
        $('input[name=ansQueInput662]').val(answer1);
        answer = '';
        $('a[href=#navpill6661]').trigger('click');
    });

    var RoleName = [],
        CombIds = [];
    //确认回答
    $('.ansAndLearn').on('click', function() {
        if ($(this).is('.ansAndLearn')) { //回答并学习
            learnFlag = 1;
        }

        $('.singleAnsCos').each(function() {
            if ($(this).prop('checked')) {
                solutionId = $(this).parents('tr').attr('solutionId');
            }
        });

        answer = $('input[name=ansQueInput662]').val();

        var roleIds1 = '';
        $('.changeChannel').each(function() {
            if (+$(this).attr('go')) {
                roleIds1 += $(this).attr('diccode') + ',';
            }
        });
        if (roleIds1) {
            roleIds1 = roleIds1.substring(0, roleIds1.length - 1);
        } else {
            roleIds1 = '-1';
        }
        CombIds = []
        CombIds = CombIds.join(',');
        if (!CombIds) {
            CombIds = '-1';
        }
        if (groupId || learnFlag === 0) {
            Base.request({
                url: 'LearnQue/doFixByNewAnswer',
                params: {
                    fixMode: 6,
                    del:1,
                    ids: ids.toString(),
                    answer: richtextUE.getContent(),
                    learnFlag: learnFlag,
                    groupId: groupId,
                    formatQue: answer,
                    effectiveRules: '[{"type":1,"roleIds":"' + roleIds1 + '"},{"type":2,"roleIds":"' + CombIds + '"}]',
                },
                callback: function(data) {
                    if (data.status) {
                        Base.gritter(data.message, false);
                    } else {
                        Base.gritter(data.message, true);
                        $('#modal-dialog-ans').modal('hide');
                        groupId = 0;
                        initSrc();
                    }
                },
            });
        } else {
            Base.gritter('请选择一个分类', false);
        }
    });
    //富文本答案
    var richtextUE = UE.getEditor('ans-textarea', {
        initialFrameHeight: 200,
        zIndex: 90,
        wordCount:true,
        maximumWords: 20000
    });

    var setting2 = {
        data: {
            simpleData: {
                enable: true,
            },
        },
        view: { //不显示图标
            showIcon: false
        },
        check: {
            //enable: true,
        },
        callback: {
            onClick: function(event, treeId, treeNode) {
                $('.closeAll2').trigger('click');
                groupId = treeNode.id - 1;
                pageNo2 = 1;
                ansQue();
                $('#ztree2').fadeOut();
                $('.selectQue').html(treeNode.name);
            }
        }
    };
    //获取问题分类
    $.ajax({
        url:'../../classes/listClasses',
        type:'post',
        data:{m:0},
        dataType:'json',
        cache:false,
        success:function(data){
            if (data.status) {
                Base.gritter(data.message, false);
            } else {
                var html = '';
                if (data.list[0]) {
                    $.ajax('/LearnQue/getListCount', {
                        type: 'get',
                        datatype: 'json',
                        cache: false, //不从缓存中去数据
                        success: function(data6) {
                            var formatData = [],
                                len = data.list.length,
                                countg = 0;
                            for (var key in data.list) {
                                var dk = data.list[key];
                                formatData[key] = {};
                                formatData[key]['name'] = dk['Name'];
                                if (data6.list[dk['Id']]) {
                                    formatData[key]['name'] = formatData[key]['name'] + '【' + data6.list[dk['Id']] + '个问题】';
                                    countg += data6.list[dk['Id']];
                                }
                                formatData[key]['pId'] = dk['ParentId'] + 1;
                                formatData[key]['id'] = dk['Id'] + 1;
                            }

                            formatData[len] = {};
                            formatData[len]['name'] = '全部分类' + '【' + countg + '个问题】';
                            formatData[len]['pId'] = 0;
                            formatData[len]['id'] = 1;
                            formatData[len]['open'] = true;


                            $.fn.zTree.init($("#ztree2"), setting2, formatData);
                        },
                        error: function() {
                            var formatData = [],
                                len = data.list.length;

                            for (var key in data.list) {
                                var dk = data.list[key];
                                formatData[key] = {};
                                formatData[key]['name'] = dk['Name'];
                                formatData[key]['pId'] = dk['ParentId'] + 1;
                                formatData[key]['id'] = dk['Id'] + 1;
                            }

                            formatData[len] = {};
                            formatData[len]['name'] = '全部分类';
                            formatData[len]['pId'] = 0;
                            formatData[len]['id'] = 1;
                            formatData[len]['open'] = true;


                            $.fn.zTree.init($("#ztree2"), setting2, formatData);
                        }
                    })
                }
            }
        }
    });
    // 显隐分类
    $('.selectQue').on('click', function(e) {
        var src=e.target || window.event.srcElement;
        if (!$(src).is('.open')) {
            $(src).addClass('open');
            $('#ztree2').fadeIn();
            $('#ztree2 li:first').slimScroll({
                height: '300px',
            });
        } else {
            $(src).removeClass('open');
            $('#ztree2').fadeOut();
        }
    });

    var setting3 = {
        data: {
            simpleData: {
                enable: true,
            },
        },
        view: { //不显示图标
            showIcon: false
        },
        check: {
            enable: true,
        },
        callback: {
            onCheck: function(event, treeId, treeNode) {
                RoleName = [];
                CombIds = [];

                var treeObj3 = $.fn.zTree.getZTreeObj("ztree3");
                var nodes3 = treeObj3.getCheckedNodes(true);

                for (var i = 0; i < nodes3.length; i++) {
                    RoleName.push(nodes3[i].name);
                    CombIds.push(nodes3[i].id);
                }
                $('.roleInput').attr({
                    title: RoleName,
                }).val(RoleName);
            }
        }
    };
    //获取来访者角色分类
    $.ajax({
        url:'../../comb/loadCombs',
        type:'post',
        data:{m:0},
        dataType:'json',
        cache:false,
        success:function(data){
            if (data.status) {
                Base.gritter(data.message, false);
            } else {
                var html = '';
                if (data.list) {
                    if (data.list[0]) {
                        var formatData = [],
                            len = data.list.length;

                        for (var key in data.list) {
                            formatData[key] = {};
                            formatData[key]['name'] = data.list[key]['Name'];
                            formatData[key]['pId'] = data.list[key]['ParentId'] + 1;
                            formatData[key]['id'] = data.list[key]['Id'] + 1;
                        }

                        formatData[len] = {};
                        formatData[len]['name'] = '全部角色';
                        formatData[len]['pId'] = 0;
                        formatData[len]['id'] = 1;

                        $.fn.zTree.init($("#ztree3"), setting3, formatData);
                    }
                }
            }
        }
    });
    //展开所有
    $('.openAll3').on('click', function() {
        var treeObj3 = $.fn.zTree.getZTreeObj("ztree3");
        treeObj3.expandAll(true);
    });
    //折叠所有
    $('.closeAll3').on('click', function() {
        var treeObj3 = $.fn.zTree.getZTreeObj("ztree3");
        treeObj3.expandAll(false);
    });

    //获取生效渠道
    $.ajax({
        url: '../../Configuration/listItem',
        type:'post',
        data:{m:0},
        dataType:'json',
        cache:false,
        success:function(data){
            if (data.status) {
                Base.gritter(data.message, false);
            } else {
                //生效渠道
                if (data.listItem[0].IsDisplay) { //不展示
                    $('.channelCtn').remove();
                } else {
                    var html = '';
                    if (data.listItem[0].DicList) {
                        for (var i = 0; i < data.listItem[0].DicList.length; i++) {
                            html += '<a href="javascript:;" class="btn btn-sm btn-white changeChannel" DicCode="' + data.listItem[0].DicList[i].DicCode + '" go="0" style="margin: 2px;">' + data.listItem[0].DicList[i].DicDesc + '</a>';
                        }
                    }
                    $('.channel').append(html);
                }

                //生效角色
                if (data.listItem[1].IsDisplay) { //不展示
                    $('.roleCtn').remove();
                }

            }
        }
    });

    //回答
    function ansQue() {
        $.ajax({
            url:'../../question/getQueList' + queryStr + answer,
            type:'post',
            data:{
                pageNo: pageNo2,
                pageSize: pageSize2,
                groupId: groupId,
                isLeaf: isLeaf,
                status: status2,
                level: level
            },
            dataType:'json',
            cache:false,
            success:function(data){
                if (data.status) {
                    Base.gritter(data.message, false);
                } else {
                    var html = '';
                    if (data.questionList && data.questionList[0]) {
                        for (var i = 0; i < data.questionList.length; i++) {
                            html += '<tr Id="' + (data.questionList[i].Id || '') + '"  SolutionId="' + (data.questionList[i].SolutionId || '') + '">';
                            html += '<td style="text-align: center;"><input class="singleAnsCos" type="radio" name="ansQue"></td>';
                            if (data.questionList[i].SolutionType == 2) {
                                var link = '/web/knowledge/editFlow.html?questionId=' + data.questionList[i].Id + '&groupId=' + data.questionList[i].GroupId + '&solutionId=' + data.questionList[i].SolutionId;
                                html += '<td class="cosInput clickop" data-link="'+link+'" data-isf="1">' + (data.questionList[i].Question || '') + '</td>';
                            } else {
                                link = '/web/knowledge/queDetail.html?id=' + data.questionList[i].Id;
                                html += '<td class="cosInput clickop" data-link="'+link+'" data-isf="0">' + (data.questionList[i].Question || '') + '</td>';
                            }
                            html += '<td class="cosInput" style="position:relative;"><div class="minheight1" style="max-width: 300px;">';
                            data.questionList[i].ListAnswer.forEach(function(el, i){
                                if(i == 0) {
                                    html += '<div class="ccca">' + (el.Answer || '') + '</div>';
                                } else {
                                    html += '<div class="ccca" style="display:none;">' + (el.Answer || '') + '</div>';
                                }
                            });
                            if(data.questionList[i].ListAnswer.length > 1) {
                                html += '</div><span style="position:absolute;top:10px;right:0;"><i class="fa fa-chevron-up rotog"></span></td>';
                            } else {
                                html += '</div></td>';
                            }
                            html += '<td>' + (data.questionList[i].AddTime || '') + '</td></tr>';
                        }
                        var options = {
                            currentPage: data.currentPage,
                            totalPages: data.totlePages ? data.totlePages : 1,
                            alignment: 'right',
                            onPageClicked: function(event, originalEvent, type, page) {
                                pageNo2 = page;
                                ansQue();
                            }
                        };
                        $('#itemContainer2').bootstrapPaginator(options);
                    } else {
                        html += '<td colspan="7" style="text-align:center;"><i class="glyphicon glyphicon-warning-sign"></i>&nbsp;&nbsp;当前纪录为空！</td>';
                        $('#itemContainer2').empty();
                    }
                    $('.tbody2').empty().append(html);
                    $('.timeTip').tooltip();
                    icheckInit();
                    $('.minheight').each(function() {
                        var height = $(this).height;
                        if (height > 100) {
                            height = 100;
                        }
                        // $('.minheight').slimScroll({
                        // height: height,
                        // });
                    })
                    $('.slimScrollBar').hide();
                    $('.rotog').on('click', function(){
                        if($(this).hasClass('fa-chevron-up')) {
                            $(this).removeClass('fa-chevron-up').addClass('fa-chevron-down');
                            $(this).parent().parent().find('.minheight1').children(':not(:first-child)').show();
                        } else {
                            $(this).removeClass('fa-chevron-down').addClass('fa-chevron-up');
                            $(this).parent().parent().find('.minheight1').children(':not(:first-child)').hide();
                        }
                    });
                    $('.clickop').on('dblclick', function(){
                        if($(this).data('isf')) {
                            ifbOpenWindowInNewTab($(this).data('link'), '流程详细');
                        } else {
                            ifbOpenWindowInNewTab($(this).data('link'), '问题详细');
                        }
                    });

                }
            }
        });
    }

    /*==========问题查询==========*/
    $('.btnSearch').unbind('click').bind('click', function(){
        question = $('.search-input-addSrc').val();
        if(question==""){
            pageNo = 1;
        }
        initSrc();
    });

    /*==========处理状态==========*/
    $('.solve_status .status').unbind('click').bind('click', function(e){
        var src = e.target || window.event.srcElement;
        status = $(src).attr('data-status');
        if(status == -1){
            status = '';
        }
        pageNo = 1;
        $('.solve_status button').html($(src).html()+'<span class="caret"></span>');
        initSrc();
    });

    /*==========是否全选==========*/
    $('body').on('ifChecked', '.multCos', function() {
        $('.singleCos').iCheck('check');
    });
    $('body').on('ifUnchecked', '.multCos', function() {
        $('.singleCos').iCheck('uncheck');
    });

    /*==========删除操作==========*/
    $('.dsf_knowledge_tbody').undelegate('.ig','click').delegate('.ig','click',function(e){
        var src = e.target || window.event.srcElement;
        var id = $(src).parents('tr').attr('id');
        var message = {
            title:'确认删除？',
            content:'删除该问题将一并删除答案与相似问法，确认删除该问题吗？'
        };
        $(src).adcCreator(function() {
            Base.request({
                url: 'ThirdKnowledgeSystem/deleteByIds',
                params: {
                    ids: id,
                },
                callback: function (data) {
                    if (data.status) {
                        var msg = data.message;
                        Base.gritter(msg, false);
                    } else {
                        Base.gritter(data.message, true);
                        initSrc();
                    }
                },
            })
        },{},message);
    });

    /*==========第三方知识系统回答查询==========*/
    function initSrc(confirmBtn) {
		if(confirmBtn){
			var sValue=$('#tm1').val().split('-');
			var eValue=$('#tm2').val().split('-');
			var startT=$('[name=startT]').val();
			var endT=$('[name=endT]').val();
			if(startT&&endT) {
				if ($('#tm1').val() && $('#tm2').val()) {
					$('.ttw').html(sValue[1] + '月' + sValue[2].split(' ')[0] + '日' + '-' + eValue[1] + '月' + eValue[2].split(' ')[0] + '日' + '&nbsp;<span class="caret"></span>');
				}
			}

		}
	
	
        startTime = $('#tm1').val();
        endTime = $('#tm2').val();
        $.ajax({
            url:'../../ThirdKnowledgeSystem/list',
            data:{
                pageNo:pageNo,
                pageSize:pageSize,
                status:status,
                orderType:orderType,
                source:source,
                question:question,
                startT:startTime,
                endT:endTime
            },
            type:'post',
            dataType:'json',
            cache:false,
            success:function(data){
                if(data.status == 0){
                    var sourceHtml = '';
                    var html = '';
                    var sourceType = '';
                    var statusType = '';
                    if(data.list&&data.list[0]){
                        //全部渠道生成
                        var sourceHtml = '<li><a class="sol" href="#" data-sol="-1">全部渠道</a></li>';
                        for (var m in data.sourceList) {
                            sourceHtml += '<li><a class="sol" href="javascript:;" data-sol="' + data.sourceList[m].DicCode + '">' + data.sourceList[m].DicDesc + '</a></li>';
                        }
                        $('#DataSourceUL').empty().append(sourceHtml);
                        if(data.sourceList[0]){
                            $('#DataSourceUL a').on('click', function() {
                                pageNo = 1;
                                source = $(this).attr('data-sol');
                                if (source == '-1') {
                                    $('.sourceType').html('全部渠道<span class="caret"></span>');
                                } else {
                                    $('.sourceType').html(getSourceName(source) + '<span class="caret"></span>');
                                }
                                initSrc();
                            });
                        }

                        //表格生成
                        $.each(data.list, function(i, item){
                            var itemContent = item.Question;
                            switch(item.SourceId){
                                case 0:
                                    sourceType = '网页';
                                    break;
                                case 1:
                                    sourceType = '微信';
                                    break;
                                case 2:
                                    sourceType = 'API';
                                    break;
                                case 3:
                                    sourceType = 'APP';
                                    break;
                                case 4:
                                    sourceType = '微博';
                                    break;
                                case 5:
                                    sourceType = '支付宝';
                                    break;
                                case 6:
                                    sourceType = '手机端';
                                    break;
                                case 7:
                                    sourceType = 'IOS';
                                    break;
                                case 8:
                                    sourceType = 'Android';
                                    break;
                                case 9:
                                    sourceType = '大屏端';
                                    break;
                                case 10:
                                    sourceType = '云问网页';
                                    break;

                            }
                            switch(item.Status){
                                case 1:
                                    statusType = '忽略处理';
                                    break;
                                case 2:
                                    statusType = '编辑处理';
                                    break;
                                case 3:
                                    statusType = '未处理';
                                    break;
                                case 4:
                                    statusType = '未接收';
                                    break;

                            }
                            html += '<tr id="'+item.Id+'" queId="'+item.QuestionId+'" groupId="'+item.GroupId+'" chatUserId="'+item.ChatUserId+'" chatversion="'+item.Chatversion+'" statusType="'+statusType+'">';
                            html += '<td><input class="singleCos" type="checkbox"></td>';
                            html += '<td>'+(itemContent||"")+'</td>';
                            html += '<td>'+sourceType+'</td>';
                            html += '<td>'+(item.GroupName||"未知分类")+'</td>';
                            html += '<td>'+item.AddTime+'</td>';
                            html += '<td>'+item.ThirdCompanyName+'</td>';
                            html += '<td>'+statusType+'</td>';
                            html += '<td style="white-space:nowrap;">';
                            html += '<a href="javascript:;" title="查看聊天记录" rel="'+item.ChatUserId+'" cv="'+item.Chatversion+'" onclick="lookChat(this, \''+itemContent+'\');return false;"><i class="timeTip clickBtn glyphicon glyphicon-eye-open" style="color:#094e8a" title="" data-original-title="查看聊天记录"></i></a>';
                            //忽略处理时，按钮可点击
                            statusType == '忽略处理' ? html += '<a><i class="timeTip ans clickBtn glyphicon glyphicon-pencil" title="" data-toggle="modal" data-target="#modal-dialog-ans" data-original-title="回答"></i>' : html += '<a><i class="timeTip ans clickBtn glyphicon glyphicon-pencil" title="" style="color:#aaa; cursor: default"></i>';
                            html += '<i class="timeTip ig clickBtn glyphicon glyphicon-eye-close" title="" data-original-title="删除"></i></a></td>';
                            html += '</tr>';
                        });

                        var options = {
                            data: [data, 'list', 'total'],
                            currentPage: data.currentPage,
                            totalPages: data.totlePages ? data.totlePages : 1,
                            alignment: 'right',
                            onPageClicked: function(event, originalEvent, type, page) {
                                pageNo = page;
                                initSrc();
                            }
                        };
                        $('#itemContainer').bootstrapPaginator(options);
                    }else{
                        html += '<tr><td colspan="8" style="text-align:center;"><i class="glyphicon glyphicon-warning-sign"></i>&nbsp;&nbsp;当前纪录为空！</td></tr>';
                        $('#itemContainer').html('');
                    }
                    $('.dsf_knowledge_tbody').html(html);
                    $('.timeTip').tooltip();
                    icheckInit();

                }
            }
        });
    }


</script>

</body>

</html>
